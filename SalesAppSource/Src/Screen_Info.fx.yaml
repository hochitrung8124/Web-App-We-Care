Screen_Info As screen:
    OnVisible: |-
        =UpdateContext({varToday: Today()});
        ClearCollect(
            data_CNKH,
            Filter('Cập nhật khách háng',Status = 'Status (Cập nhật khách háng)'.Active And 'Created On' >= DateAdd(varToday,-3) And Email_user = mail_sale)
        );

    Container4_1 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGridColumns: =6
        LayoutGridRows: =6
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =Parent.Width
        ZIndex: =1

        Container6_2 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.Center
            DropShadow: =DropShadow.None
            Fill: =RGBA(219, 219, 219, 1)
            FillPortions: =0
            Height: =Parent.Height
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            Rectangle3_1 As rectangle:
                Fill: =RGBA(4, 161, 179, 1)
                Height: =90
                Width: =Parent.Width
                ZIndex: =1

            c_info_checkin As groupContainer.manualLayoutContainer:
                DropShadow: =DropShadow.Bold
                Fill: =RGBA(255, 255, 255, 1)
                Height: =1141
                LayoutGridColumns: =6
                LayoutGridRows: =6
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Width: =Parent.Width -40
                X: =20
                Y: =201
                ZIndex: =2

                "g_CNKH As gallery.'BrowseLayout_Vertical_OneTextOneImageVariant_ver4.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(77, 77, 77, 1)
                    BorderThickness: =1
                    DelayItemLoading: =true
                    Fill: =RGBA(236, 236, 235, 1)
                    Height: =984
                    Items: =list_checkInOut
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    OnSelect: =
                    TemplatePadding: =20
                    TemplateSize: =186
                    Width: =Parent.Width
                    Y: =157
                    ZIndex: =1

                    Button10 As button:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        Fill: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Segoe UI'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverFill: =RGBA(255, 255, 255, 1)
                        OnSelect: =Select(Parent)
                        PressedBorderColor: =RGBA(0, 69, 120, 1)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        RadiusBottomLeft: =20
                        RadiusBottomRight: =20
                        RadiusTopLeft: =20
                        RadiusTopRight: =20
                        Text: =""
                        Width: =Parent.TemplateWidth
                        ZIndex: =1

                    Title11 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(77, 77, 77, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =50
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingRight: =10
                        PaddingTop: =0
                        Size: =20
                        Text: =ThisItem.'Khách hàng CAL'
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.TemplateWidth
                        Y: =5
                        ZIndex: =2

                    Title11_1 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(26, 26, 26, 1)
                        Font: =Font.Arial
                        Height: =Self.Size * 1.8
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =20
                        Text: =ThisItem.'Thời gian check in' & " - " & ThisItem.'Thời gian check out'
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.TemplateWidth
                        Y: =Title11_2.Y + Title11_2.Height + 5
                        ZIndex: =4

                    Title11_2 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(26, 26, 26, 1)
                        Font: =Font.Arial
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =20
                        Text: =ThisItem.'Trạng thái gặp khách'
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.TemplateWidth
                        Y: =Title11.Y + Title11.Height
                        ZIndex: =5

                    Title11_3 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(26, 26, 26, 1)
                        Font: =Font.Arial
                        Height: =Self.Size * 1.8
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =20
                        Text: |-
                            ="Tổng: " & Text(
                                Value(ThisItem.'Tổng thời gian chăm sóc (s)') / 60,
                                "#"
                            ) & " phút. "
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.TemplateWidth
                        Y: =Title11_1.Height +Title11_1.Y +5
                        ZIndex: =6

                Label6_5 As label:
                    Color: =RGBA(51, 51, 51, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =50
                    PaddingLeft: =20
                    Size: =24
                    Text: ="Lịch sử check-in"
                    Width: =Parent.Width
                    Y: =10
                    ZIndex: =2

                Label6_6 As label:
                    Color: =RGBA(26, 26, 26, 1)
                    Font: =Font.Arial
                    PaddingLeft: =20
                    Size: =20
                    Text: |
                        =With( 
                            {
                                totalMinutes: Sum(list_checkInOut, 'Tổng thời gian chăm sóc (s)') / 60,
                                uniqueCheckIns: CountRows(
                                    GroupBy(
                                        list_checkInOut,
                                        'Mã KH',
                                        grouped
                                    )
                                )
                            },
                            "Đã check in: " & uniqueCheckIns & 
                            " lần - TG Chăm sóc: " & 
                            If(
                                totalMinutes >= 60,
                                Round(totalMinutes / 60, 1) & " giờ",
                                Round(totalMinutes, 0) & " phút"
                            )
                        )
                    Width: =Parent.Width
                    Y: =60
                    ZIndex: =3

                Label6_7 As label:
                    Color: =RGBA(26, 26, 26, 1)
                    Font: =Font.Arial
                    PaddingLeft: =20
                    Size: =20
                    Text: |-
                        ="Tháng này đã check in: " & nv_sale.'Tổng check in (tháng)' & " lần"
                    Width: =Parent.Width
                    Y: =Label6_6.Y+Label6_6.Height
                    ZIndex: =4

            Label2_2 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Font: =Font.Arial
                FontWeight: =FontWeight.Bold
                Height: =90
                Size: =34
                Text: |-
                    =//varUser.'Tên nhân viên'
                    nv_sale.Name
                Width: =Parent.Width
                Y: =5
                ZIndex: =3

            Image11_2 As image:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =50
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(0, 0, 0, 0)
                Image: =back_white
                OnSelect: =Navigate(Main)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =70
                X: =20
                Y: =20
                ZIndex: =4

            Button8 As button:
                Color: =RGBA(77, 77, 77, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Font: =Font.Arial
                Height: =50
                HoverBorderColor: =RGBA(219, 219, 219, 1)
                HoverColor: =RGBA(77, 77, 77, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                PressedColor: =RGBA(77, 77, 77, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =25
                RadiusBottomRight: =25
                RadiusTopLeft: =25
                RadiusTopRight: =25
                Size: =20
                Text: =Text(varToday, "dd/mm/yyyy")
                Width: =180
                X: =(Parent.Width - Button8.Width)/2
                Y: =Label2_2.Y + Label2_2.Height + 20
                ZIndex: =6

            Icon5 As icon.Add:
                Color: =RGBA(77, 77, 77, 1)
                DisplayMode: =If(DateAdd(varToday,3) = Today(), DisplayMode.Disabled, DisplayMode.Edit)
                Height: =50
                Icon: =Icon.ChevronLeft
                OnSelect: |-
                    =UpdateContext({varToday: DateAdd(varToday, -1)})
                Width: =50
                X: =238
                Y: =Button8.Y
                ZIndex: =7

            Icon5_1 As icon.Add:
                Color: =RGBA(77, 77, 77, 1)
                DisplayMode: =If(varToday = Today(), DisplayMode.Disabled, DisplayMode.Edit)
                Height: =50
                Icon: =Icon.ChevronRight
                OnSelect: |-
                    =UpdateContext({varToday: DateAdd(varToday, 1)})
                Width: =50
                X: =474
                Y: =115
                ZIndex: =8

