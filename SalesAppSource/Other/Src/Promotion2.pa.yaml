# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Promotion2:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container6:
          Control: GroupContainer@1.4.0
          Variant: ManualLayout
          Properties:
            BorderColor: =RGBA(77, 77, 77, 1)
            Fill: =RGBA(4, 161, 179, 1)
            Height: =141
            Width: =766
          Children:
            - Label9:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 255, 255, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =70
                  Size: =30
                  Text: |-
                    ="Promotion
                    "
                  Width: =766
            - Icon1_6:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 255, 255, 1)
                  Height: =118
                  Icon: =Icon.ArrowLeft
                  OnSelect: =Back();
                  Width: =60
                  X: =17
            - txt_searchPromotion2:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(116, 116, 116, 1)
                  BorderThickness: =1
                  Color: =RGBA(77, 77, 77, 1)
                  Default: =""
                  DisabledBorderColor: =RGBA(0, 0, 0, 0)
                  Font: =Font.Arial
                  Height: =60
                  HintText: ="T√™n Ch∆∞∆°ng tr√¨nh"
                  HoverBorderColor: =RGBA(0, 0, 0, 0)
                  HoverColor: =RGBA(116, 116, 116, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  PressedBorderColor: =
                  PressedFill: =
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Size: =24
                  Width: =Parent.Width - 160
                  X: =83
                  Y: =70
      - c_info_checkin_2:
          Control: GroupContainer@1.4.0
          Variant: ManualLayout
          Properties:
            DropShadow: =DropShadow.Bold
            Fill: =RGBA(255, 255, 255, 1)
            Height: =1145
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Width: =Parent.Width -40
            X: =20
            Y: =196
          Children:
            - Gallery2:
                Control: Gallery@2.15.0
                Variant: Vertical
                Properties:
                  BorderColor: =RGBA(77, 77, 77, 1)
                  Height: =1145
                  Items: |
                    =SortByColumns(
                        AddColumns(
                            Filter(
                                Promotion_1,
                                'Promotion Deactive' = "Active" &&
                                Status = 'Status (Promotion_1)'.Active &&

                                // ‚úÖ L·ªçc nh√≥m s·∫£n ph·∫©m √°p d·ª•ng (multi + r·ªóng/null)
                                (
                                    IsBlank('Nh√≥m s·∫£n ph·∫©m √°p d·ª•ng') ||
                                    'Nh√≥m s·∫£n ph·∫©m √°p d·ª•ng' = "" ||
                                    Find(
                                        "," & Lower(Trim(onlect)) & ",",
                                        "," & Lower(Trim('Nh√≥m s·∫£n ph·∫©m √°p d·ª•ng')) & ","
                                    ) > 0
                                ) &&

                                // üîç T√¨m ki·∫øm theo t√™n Promotion
                                (
                                    IsBlank(txt_searchPromotion2.Text) ||
                                    StartsWith(Lower(Promotion), Lower(txt_searchPromotion2.Text)) ||
                                    Lower(txt_searchPromotion2.Text) in Lower(Promotion)
                                ) &&

                                // üåç L·ªçc v√πng mi·ªÅn / nh√≥m kh√°ch h√†ng
                                (
                                    IsBlank(vungMien_Sale) ||
                                    IsBlank('Nh√≥m BG kh√°ch h√†ng √°p d·ª•ng'.'Nh√≥m kh√°ch h√†ng') ||
                                    'Nh√≥m BG kh√°ch h√†ng √°p d·ª•ng'.'Nh√≥m kh√°ch h√†ng' = Text(vungMien_Sale) ||
                                    'Nh√≥m BG kh√°ch h√†ng √°p d·ª•ng'.'Nh√≥m kh√°ch h√†ng' = "Shop"
                                )
                            ),
                            outdate,
                            If(
                                Duration >= -72 && !IsBlank(Duration),
                                0,
                                1
                            )
                        ),
                        "outdate",
                        SortOrder.Ascending,
                        "crdfd_start_date",
                        SortOrder.Descending
                    )
                  OnSelect: |-
                    =Set(
                        varShowPDF1, true
                    );
                    Set(
                        SelectedPromotion,
                        ThisItem
                    );
                    Navigate(PromitionDetail2, ScreenTransition.Fade);
                  TemplateSize: =94
                  Width: =728
                Children:
                  - HtmlText3_1:
                      Control: HtmlViewer@2.1.0
                      Properties:
                        Font: =Font.'Open Sans'
                        Height: =84
                        HtmlText: |
                          ="<div style='
                            width:98%;
                            font-family:Segoe UI, Arial;
                            font-size:15px;
                            color:#1a1a1a;
                            border:1.5px solid #cce4ff;
                            border-radius:10px;
                            padding:8px 10px;
                            background-color:#f9fcff;
                            box-shadow:0px 2px 4px rgba(0,0,0,0.04);
                            line-height:1.3;
                            box-sizing:border-box;
                            margin:auto;
                            overflow:hidden;
                          '>

                            <!-- Promotion Title -->
                            <div style='
                              font-weight:700;
                              color:#04a1b3;
                              font-size:15px;
                              margin-bottom:4px;
                              word-wrap:break-word;
                              display:flex;
                              align-items:center;
                              gap:8px;
                              flex-wrap:wrap;
                            '> 
                              " & ThisItem.Promotion & "_" & 

                              // üî¥ ∆Øu ti√™n hi·ªÉn th·ªã ‚ÄúS·∫ÆP H·∫æT H·∫†N‚Äù n·∫øu c√≤n <=72 gi·ªù (>=0)
                              If(
                                !IsBlank(ThisItem.'End date') &&
                                DateDiff(
                                  DateAdd(Now(), 7, TimeUnit.Hours),
                                  DateAdd(ThisItem.'End date', 7, TimeUnit.Hours),
                                  TimeUnit.Hours
                                ) >= 0 &&
                                DateDiff(
                                  DateAdd(Now(), 7, TimeUnit.Hours),
                                  DateAdd(ThisItem.'End date', 7, TimeUnit.Hours),
                                  TimeUnit.Hours
                                ) <= 72,
                                "<span style='
                                  background:linear-gradient(90deg,#ff3b3b,#ff8a8a);
                                  color:#ffffff;
                                  font-size:11px;
                                  font-weight:700;
                                  padding:3px 9px;
                                  border-radius:12px;
                                  margin-left:4px;
                                  letter-spacing:0.5px;
                                  text-transform:uppercase;
                                  box-shadow:0px 2px 4px rgba(255,59,59,0.4);
                                '>S·∫ÆP H·∫æT H·∫†N</span>",

                                // üü† N·∫øu kh√¥ng, ki·ªÉm tra NEW (Start date trong 7 ng√†y)
                                If(
                                  !IsBlank(ThisItem.'Start date') &&
                                  DateDiff(ThisItem.'Start date', Today(), TimeUnit.Days) <= 7 &&
                                  DateDiff(ThisItem.'Start date', Today(), TimeUnit.Days) >= 0,
                                  "<span style='
                                    background:linear-gradient(90deg,#ff6a00,#ffb347);
                                    color:#ffffff;
                                    font-size:11px;
                                    font-weight:700;
                                    padding:3px 9px;
                                    border-radius:12px;
                                    margin-left:4px;
                                    letter-spacing:0.5px;
                                    text-transform:uppercase;
                                    box-shadow:0px 2px 4px rgba(255,106,0,0.4);
                                  '>NEW</span>",
                                  ""
                                )
                              ) &
                            "</div>

                            <!-- Start - End Date -->
                            " & If(
                                !IsBlank(ThisItem.'Start date') || !IsBlank(ThisItem.'End date'),
                                "<div style='margin-bottom:4px; display:flex; align-items:center; flex-wrap:wrap;'>
                                  <span style='font-size:13px; margin-right:4px;'>üïí</span>
                                  <span><b>Start - End:</b> " &
                                    If(!IsBlank(ThisItem.'Start date'),
                                       Text(ThisItem.'Start date', "dd/mm/yyyy"),
                                       ""
                                    ) &
                                    If(!IsBlank(ThisItem.'End date'),
                                       " - " & Text(ThisItem.'End date', "dd/mm/yyyy"),
                                       ""
                                    ) &
                                  "</span>
                                </div>",
                                ""
                              ) & "
                          </div>"
                        OnSelect: =Select(Parent)
                        PaddingBottom: =8
                        PaddingRight: =8
                        Width: =702
                        X: =16
      - Label10_6:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(237, 237, 237, 1)
            Fill: =RGBA(62, 128, 149, 1)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Bold
            Height: =55
            Size: =15
            Text: |
              ="√Åp d·ª•ng cho : " & nv_sale.Location.'V√πng mi·ªÅn fx'
            Width: =765
            Y: =141
