# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Screen_Info:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: |-
        =UpdateContext({varToday: Today()});
        ClearCollect(
            data_CNKH,
            Filter('Cập nhật khách háng',Status = 'Status (Cập nhật khách háng)'.Active And 'Created On' >= DateAdd(varToday,-3) And Email_user = mail_sale)
        );
    Children:
      - Container4_1:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =App.Height
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutOverflowY: =LayoutOverflow.Scroll
            Width: =Parent.Width
          Children:
            - Container6_2:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  AlignInContainer: =AlignInContainer.Center
                  DropShadow: =DropShadow.None
                  Fill: =RGBA(219, 219, 219, 1)
                  FillPortions: =0
                  Height: =Parent.Height
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  LayoutMinHeight: =112
                  Width: =Parent.Width
                Children:
                  - Rectangle3_1:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(4, 161, 179, 1)
                        Height: =90
                        Width: =Parent.Width
                  - c_info_checkin:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.Bold
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =1141
                        RadiusBottomLeft: =20
                        RadiusBottomRight: =20
                        RadiusTopLeft: =20
                        RadiusTopRight: =20
                        Width: =Parent.Width -40
                        X: =20
                        Y: =201
                      Children:
                        - g_CNKH:
                            Control: Gallery@2.15.0
                            Variant: BrowseLayout_Vertical_OneTextOneImageVariant_ver4.0
                            Properties:
                              BorderColor: =RGBA(77, 77, 77, 1)
                              BorderThickness: =1
                              DelayItemLoading: =true
                              Fill: =RGBA(236, 236, 235, 1)
                              Height: =984
                              Items: =list_checkInOut
                              LoadingSpinner: =LoadingSpinner.Data
                              OnSelect: =
                              TemplatePadding: =20
                              TemplateSize: =186
                              Width: =Parent.Width
                              Y: =157
                            Children:
                              - Button10:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    DisabledFill: =RGBA(242, 242, 241, 0)
                                    Fill: =RGBA(255, 255, 255, 1)
                                    Font: =Font.'Segoe UI'
                                    Height: =Parent.TemplateHeight
                                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =RGBA(255, 255, 255, 1)
                                    OnSelect: =Select(Parent)
                                    PressedBorderColor: =RGBA(0, 69, 120, 1)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(255, 255, 255, 1)
                                    RadiusBottomLeft: =20
                                    RadiusBottomRight: =20
                                    RadiusTopLeft: =20
                                    RadiusTopRight: =20
                                    Text: =""
                                    Width: =Parent.TemplateWidth
                              - Title11:
                                  Control: Label@2.5.1
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    Color: =RGBA(77, 77, 77, 1)
                                    Font: =Font.Arial
                                    FontWeight: =FontWeight.Bold
                                    Height: =50
                                    OnSelect: =Select(Parent)
                                    PaddingBottom: =0
                                    PaddingLeft: =20
                                    PaddingRight: =10
                                    PaddingTop: =0
                                    Size: =20
                                    Text: =ThisItem.'Khách hàng CAL'
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =Parent.TemplateWidth
                                    Y: =5
                              - Title11_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    Color: =RGBA(26, 26, 26, 1)
                                    Font: =Font.Arial
                                    Height: =Self.Size * 1.8
                                    OnSelect: =Select(Parent)
                                    PaddingBottom: =0
                                    PaddingLeft: =20
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =20
                                    Text: =ThisItem.'Thời gian check in' & " - " & ThisItem.'Thời gian check out'
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =Parent.TemplateWidth
                                    Y: =Title11_2.Y + Title11_2.Height + 5
                              - Title11_2:
                                  Control: Label@2.5.1
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    Color: =RGBA(26, 26, 26, 1)
                                    Font: =Font.Arial
                                    OnSelect: =Select(Parent)
                                    PaddingBottom: =0
                                    PaddingLeft: =20
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =20
                                    Text: =ThisItem.'Trạng thái gặp khách'
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =Parent.TemplateWidth
                                    Y: =Title11.Y + Title11.Height
                              - Title11_3:
                                  Control: Label@2.5.1
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    Color: =RGBA(26, 26, 26, 1)
                                    Font: =Font.Arial
                                    Height: =Self.Size * 1.8
                                    OnSelect: =Select(Parent)
                                    PaddingBottom: =0
                                    PaddingLeft: =20
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =20
                                    Text: |-
                                      ="Tổng: " & Text(
                                          Value(ThisItem.'Tổng thời gian chăm sóc (s)') / 60,
                                          "#"
                                      ) & " phút. "
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =Parent.TemplateWidth
                                    Y: =Title11_1.Height +Title11_1.Y +5
                        - Label6_5:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(51, 51, 51, 1)
                              Font: =Font.Arial
                              FontWeight: =FontWeight.Bold
                              Height: =50
                              PaddingLeft: =20
                              Size: =24
                              Text: ="Lịch sử check-in"
                              Width: =Parent.Width
                              Y: =10
                        - Label6_6:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(26, 26, 26, 1)
                              Font: =Font.Arial
                              PaddingLeft: =20
                              Size: =20
                              Text: |+
                                =With( 
                                    {
                                        totalMinutes: Sum(list_checkInOut, 'Tổng thời gian chăm sóc (s)') / 60,
                                        uniqueCheckIns: CountRows(
                                            GroupBy(
                                                list_checkInOut,
                                                'Mã KH',
                                                grouped
                                            )
                                        )
                                    },
                                    "Đã check in: " & uniqueCheckIns & 
                                    " lần - TG Chăm sóc: " & 
                                    If(
                                        totalMinutes >= 60,
                                        Round(totalMinutes / 60, 1) & " giờ",
                                        Round(totalMinutes, 0) & " phút"
                                    )
                                )
                              Width: =Parent.Width
                              Y: =60
                        - Label6_7:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(26, 26, 26, 1)
                              Font: =Font.Arial
                              PaddingLeft: =20
                              Size: =20
                              Text: |-
                                ="Tháng này đã check in: " & nv_sale.'Tổng check in (tháng)' & " lần"
                              Width: =Parent.Width
                              Y: =Label6_6.Y+Label6_6.Height
                  - Label2_2:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =90
                        Size: =34
                        Text: |-
                          =//varUser.'Tên nhân viên'
                          nv_sale.Name
                        Width: =Parent.Width
                        Y: =5
                  - Image11_2:
                      Control: Image@2.2.3
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =50
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Image: =back_white
                        OnSelect: =Navigate(Main)
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Width: =70
                        X: =20
                        Y: =20
                  - Button8:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =RGBA(77, 77, 77, 1)
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        Font: =Font.Arial
                        Height: =50
                        HoverBorderColor: =RGBA(219, 219, 219, 1)
                        HoverColor: =RGBA(77, 77, 77, 1)
                        HoverFill: =RGBA(255, 255, 255, 1)
                        PressedBorderColor: =Self.Fill
                        PressedColor: =RGBA(77, 77, 77, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        RadiusBottomLeft: =25
                        RadiusBottomRight: =25
                        RadiusTopLeft: =25
                        RadiusTopRight: =25
                        Size: =20
                        Text: =Text(varToday, "dd/mm/yyyy")
                        Width: =180
                        X: =(Parent.Width - Button8.Width)/2
                        Y: =Label2_2.Y + Label2_2.Height + 20
                  - Icon5:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(77, 77, 77, 1)
                        DisplayMode: =If(DateAdd(varToday,3) = Today(), DisplayMode.Disabled, DisplayMode.Edit)
                        Height: =50
                        Icon: =Icon.ChevronLeft
                        OnSelect: |-
                          =UpdateContext({varToday: DateAdd(varToday, -1)})
                        Width: =50
                        X: =238
                        Y: =Button8.Y
                  - Icon5_1:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(77, 77, 77, 1)
                        DisplayMode: =If(varToday = Today(), DisplayMode.Disabled, DisplayMode.Edit)
                        Height: =50
                        Icon: =Icon.ChevronRight
                        OnSelect: |-
                          =UpdateContext({varToday: DateAdd(varToday, 1)})
                        Width: =50
                        X: =474
                        Y: =115
