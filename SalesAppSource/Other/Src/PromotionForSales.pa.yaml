# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  PromotionForSales:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container3_1:
          Control: GroupContainer@1.4.0
          Variant: ManualLayout
          Properties:
            Fill: =RGBA(4, 161, 179, 1)
            Height: =197
            Width: =765
            X: =3
          Children:
            - Label10_4:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 255, 255, 1)
                  DisabledBorderColor: =RGBA(237, 237, 237, 1)
                  Fill: =RGBA(4, 161, 179, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =118
                  Size: =32
                  Text: ="Promotion by product group"
                  Width: =765
            - Icon6_5:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 255, 255, 1)
                  Height: =60
                  Icon: =Icon.ArrowLeft
                  OnSelect: =Back()
                  Width: =60
                  X: =16
                  Y: =5
            - Label10_5:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(255, 255, 255, 1)
                  DisabledBorderColor: =RGBA(237, 237, 237, 1)
                  Fill: =RGBA(4, 161, 179, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =59
                  Size: =15
                  Text: |+
                    ="Áp dụng cho : " & nv_sale.Location.'Vùng miền fx'
                  Width: =765
                  Y: =136
      - Container2_1:
          Control: GroupContainer@1.4.0
          Variant: ManualLayout
          Properties:
            BorderColor: =RGBA(77, 77, 77, 1)
            Fill: =RGBA(219, 219, 219, 1)
            Height: =1169
            Width: =765
            X: =3
            Y: =197
          Children:
            - Gallery1_1:
                Control: Gallery@2.15.0
                Variant: Vertical
                Properties:
                  BorderColor: =RGBA(77, 77, 77, 1)
                  Height: =1164
                  Items: =colUniqueIDs
                  OnSelect: |-
                    =ClearCollect(
                        PromotionSelect,
                        Search(
                            Switch(
                                    true,
                                    isApplyMienNamLogic, Data_PromotionMienNamLogic,
                                    isApplyMienTrungLogic, Data_PromotionMienTrungLogic
                            ),
                            ThisItem.Value,
                            'Nhóm sản phẩm áp dụng'
                        )
                    );
                    Navigate(Promotion2);
                    Set(onlect,ThisItem.Value);
                  TemplateSize: =152
                  Width: =760
                  Y: =4
                Children:
                  - HtmlText4_1:
                      Control: HtmlViewer@2.1.0
                      Properties:
                        Font: =Font.'Open Sans'
                        Height: =144
                        HtmlText: |
                          ="<div style='
                            display:block;
                            width:100%;
                            max-width:700px;
                            min-height:140px;
                            font-family:Segoe UI, Arial;
                            font-size:15px;
                            color:#1a1a1a;
                            border:1.5px solid #cce4ff;
                            border-radius:10px;
                            padding:10px 16px;
                            background-color:#f9fcff;
                            box-shadow:0 2px 4px rgba(0,0,0,0.08);
                            line-height:1.4;
                            box-sizing:border-box;
                            margin:auto;
                          '>

                            <!-- Flex container -->
                            <div style='
                                display:flex;
                                align-items:center;
                                gap:16px;
                            '>" &

                            If(
                                !IsBlank(LookUp('Product groups', ID = GUID(ThisItem.Value)).image_url),
                                With(
                                    {
                                        recordSP: LookUp('Product groups', ID = GUID(ThisItem.Value)),
                                        imgURL: LookUp('Product groups', ID = GUID(ThisItem.Value)).image_url,
                                        nhomSP: LookUp('Product groups', ID = GUID(ThisItem.Value)).'Nhóm sản phẩm',
                                        soSKU: LookUp('Product groups', ID = GUID(ThisItem.Value)).'Loại sản phẩm',
                                        giaMin: LookUp('Product groups', ID = GUID(ThisItem.Value)).'Giá Min',
                                        giaMax: LookUp('Product groups', ID = GUID(ThisItem.Value)).'Giá Max'
                                    },
                                    With(
                                        {
                                            giaText: If(
                                                !IsBlank(giaMin) && !IsBlank(giaMax),
                                                "Giá bán: " & Text(giaMin, "#,###") & " - " & Text(giaMax, "#,###"),
                                                If(
                                                    !IsBlank(giaMin),
                                                    "Giá bán: " & Text(giaMin, "#,###"),
                                                    If(
                                                        !IsBlank(giaMax),
                                                        "Giá bán: " & Text(giaMax, "#,###"),
                                                        ""
                                                    )
                                                )
                                            )
                                        },
                                        "
                                        <!-- Left side: Image -->
                                        <div style='
                                            flex:0 0 120px;
                                            height:100px;
                                            display:flex;
                                            justify-content:center;
                                            align-items:center;
                                            overflow:hidden;
                                            border-radius:10px;
                                            border:2px solid #d9d9d9;
                                            background-color:#ffffff;
                                        '>
                                            <img src='" & imgURL & "' 
                                                 style='max-width:90%; max-height:90%; object-fit:contain; border-radius:6px;'/>
                                        </div>

                                        <!-- Right side: Info -->
                                        <div style='
                                            flex:1;
                                            text-align:left;
                                        '>
                                            <div style='font-weight:700; color:#000000; font-size:20px; margin-bottom:4px;'>" & nhomSP &  "</div>
                                            <div style='font-size:15px;'>" & soSKU & " SKUs</div>
                                            " & If(!IsBlank(giaText), "<div style='font-size:15px;'>" &  "</div>", "") & "
                                        </div>"
                                    )
                                ),
                                "<div style='flex:1; color:gray; font-style:italic;'>Không có hình ảnh</div>"
                            ) &

                            "</div>
                          </div>"
                        OnSelect: =Select(Parent)
                        Size: =28
                        Width: =750
